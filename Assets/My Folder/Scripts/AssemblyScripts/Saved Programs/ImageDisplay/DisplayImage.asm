.line
.col
.indexStart
.line_length = 36
.val

start:
    LDA #20
    STA val
    LDA #$7000
    STA indexStart

@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #0
@add_char #0
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
@add_char #3
JSR new_line
    HLT

~add_char 1 {
.index
    LDA ^1
    PHA
    @mul #(line_length) line
    ADD col
    ADD indexStart
    STA index
    PLA
    STA [index], 0
    LDA col
    SUB #(line_length)
    BEQ else
    INC col
    DUP
    JMP end
else:
    JSR new_line
end:
}

new_line:
    INC line
    LDA #0
    STA col
    RTS

~mul 2 {
; A, B
    LDA #0
loop_mul:
    LDX ^2
    BEQ end_mul
    ADD ^1
    DEC ^2
    JMP loop_mul
end_mul:
}