.line   2000
.col   2001
.index   2002
.indexStart = $7000
.actual_index   2003
.line_length = 36
.pix_length = 648
.val   2004
.cursor_val = 4
.show_cursor   2005
.cursor_wait   2006
.return_key = $FE
.backspace_key = $FF
start:
    0000  LDA #0
    0002  STA val
    0004  LDA #10000
    0006  STA cursor_wait
loop:
    0008  LDX cursor_wait
cursor_loop:
    000A  DEX
    000B  BNE cursor_loop
    000D  LDA show_cursor
    000F  BEQ set_cursor_one
    0011  DEC show_cursor
    0013  @set_char #0
    0015  JMP set_cursor_end
set_cursor_one:
    0017  INC show_cursor
    0019  @set_char #4
set_cursor_end:
    001B  JMP loop
    001D  ~set_char 1 {
    001F  LDA index
    0021  ADD #(indexStart)
    0023  STA actual_index
    0025  LDA ^1
    0027  STA [actual_index], 0
    0029  DUP
    002A  }
new_line:
.mod_val   2007
    002B  PHA
    002C  @mod index #(line_length)
    002E  STA mod_val
    0030  LDA #(line_length)
    0032  SUB mod_val
    0034  ADD index
    0036  STA index
    0038  CMP #(pix_length)
    003A  BNE check_pix_end
    003C  LDA #0
    003E  STA index
    0040  CLS
check_pix_end:
    0041  PLA
    0042  RTS
    0043  ~mod 2 {
    0045  LDA ^1
mod_loop:
    0047  CMP ^2
    0049  BCC break_mod
    004B  SUB ^2
    004D  JMP mod_loop
break_mod:
    004F  }
return:
    0050  @set_char #0
    0052  JSR new_line
    0054  JMP intrupt_end
backspace:
    0056  @set_char #0
    0058  DEC index
    005A  @set_char #0
    005C  JMP intrupt_end
intrupt:
    005E  LDA $6F00
    0060  STA val
    0062  TXA
    0063  PHA
    0064  LDA val
    0066  CMP #(return_key)
    0068  BEQ return
    006A  CMP #(backspace_key)
    006C  BEQ backspace
    006E  @set_char val
    0070  INC index
intrupt_end:
    0072  PLA
    0073  TAX
    0074  RTS
    0075  ` $6DF0
    0077  JMP intrupt
